<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Karte</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='css/karte.css') }}">
</head>
<body>


<!-- Countdown Progress Bar -->
<div id="progress-container">
    <div id="progress-bar"></div>
    <span id="progress-count">5</span>
</div>

<div class="karte-wrapper">

    <!--  Karte -->
    <div class="map-container">
        
        <img src="{{ url_for('static', filename=map_file) }}" alt="Karte" class="map-image">

        <!-- Pfeil + Linie als SVG -->
        <svg id="arrow" class="arrow" width="180" height="300" viewBox="0 0 160 160">

            <!-- Kreis unten -->
            <circle id="arrow-dot" cx="80" cy="120" r="5" fill="black"/>

            <!-- Vertikale dicke Linie -->
            <line id="arrow-vertical" x1="80" y1="120" x2="80" y2="20"
                stroke="black" stroke-width="3" stroke-linecap="round"/>

            <!-- Horizontale dicke Linie -->
            <line id="arrow-horizontal" x1="80" y1="20" x2="150" y2="20"
                stroke="black" stroke-width="3" stroke-linecap="round"/>

            <!-- Pfeilspitze -->
            <path id="arrow-tip" d="M150 15 L165 20 L150 25 Z" fill="black"/>
        </svg>
    </div>


    <div class="map-info">
    <!-- Etage -->
        <h1>
            {% if session.lang == 'en' %}
                {% if floor == "EG" %}
                    Ground Floor
                {% else %}
                    {{ floor }}. Floor
                {% endif %}
            {% else %}
                {% if floor == "EG" %}
                    EG
                {% else %}
                    {{ floor }}. OG
                {% endif %}
            {% endif %}
        </h1>
        <!-- Raum -->
        <h1>
            {% if session.lang == 'en' %}
                Room B{{ room }}
            {% else %}
                Raum B{{ room }}
            {% endif %}
        </h1>
        <!-- Dynamische Wegbeschreibung -->
        <div class="steps-list">
            <ul>
                {% for step in steps %}
                    <li>{{ step }}</li>
                {% endfor %}
            </ul>
        </div>
        <!-- Stopp-Button -->
        <form action="{{ url_for('stop_action') }}" method="POST">
            <button type="submit" class="stop-btn" id="stop-btn">
                {% if session.lang == 'en' %}
                    Stop
                {% else %}
                    Stopp
                {% endif %}
            </button>
        </form>
</div>


</div>

<!-- Pfeil -->
<script src="{{ url_for('static', filename='js/karte.js') }}"></script>
<script>
    setArrow("{{ direction }}");
</script>

<!-- Countdown Logic -->
<script>
    let seconds = 5;
    const countEl = document.getElementById("progress-count");
    const container = document.getElementById("progress-container");
    const stopBtn = document.getElementById("stop-btn");

    const interval = setInterval(() => {
        seconds--;
        countEl.textContent = seconds;

        if (seconds <= 0) {
            clearInterval(interval);

            // Progress-Bar ausblenden
            container.style.display = "none";

            // Stopp-Button entfernen
            stopBtn.style.display = "none";
        }
    }, 1000);
</script>

